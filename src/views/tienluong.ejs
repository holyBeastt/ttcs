<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H·ªçc Vi·ªán K·ªπ Thu·∫≠t M·∫≠t M√£</title>
    <link rel="stylesheet" href="/css/table.css" />
    <link rel="stylesheet" href="/css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="/css/styles.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.16/dist/sweetalert2.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.16/dist/sweetalert2.all.min.js"></script>
  </head>

  <body>
    <%- include('adminHeader') %>

    <div class="container my-5 box">
      <form id="tienluongForm" action="/tienluong" method="POST" class="row">
        <div class="col-md-4">
          <label for="he_dao_tao">H·ªá ƒê√†o T·∫°o</label>
          <select
            name="he_dao_tao"
            id="he_dao_tao"
            class="form-control"
            required
          >
            <option value="">-- Ch·ªçn h·ªá ƒë√†o t·∫°o --</option>
          </select>
        </div>
        <div class="col-md-4" id="hocViContainer">
          <label for="HocVi">H·ªçc V·ªã:</label>
          <select name="HocVi" id="HocVi" class="form-control" required>
            <option value="C·ª≠ nh√¢n">C·ª≠ nh√¢n</option>
            <option value="K·ªπ s∆∞">K·ªπ s∆∞</option>
            <option value="Th·∫°c sƒ©" selected>Th·∫°c sƒ©</option>
            <option value="Ti·∫øn sƒ©">Ti·∫øn sƒ©</option>
            <option value="Ph√≥ gi√°o s∆∞">Ph√≥ gi√°o s∆∞</option>
            <option value="Gi√°o s∆∞">Gi√°o s∆∞</option>
            <option value="Ti·∫øng kh∆°-me">Ti·∫øng kh∆°-me</option>
            <option value="V√µ s∆∞">V√µ s∆∞</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="SoTien">S·ªë Ti·ªÅn:</label>
          <input
            type="number"
            name="SoTien"
            id="SoTien"
            class="form-control"
            required
          />
        </div>
        <div style="margin-top: 15px;"></div>
        <div class="col-md-4">
          <label for="do_uu_tien">ƒê·ªô ∆∞u ti√™n</label>
          <select
            name="do_uu_tien"
            id="do_uu_tien"
            class="form-control"
            required
          >
          </select>
        </div>
        <div class="col-md-4">
          <label for="chuc_danh">Ch·ª©c danh</label>
          <select
            name="chuc_danh"
            id="chuc_danh"
            class="form-control"
            required
          >
          </select>
        </div>
        <div class="col-md-4">
          <label for="hsl">H·ªá s·ªë l∆∞∆°ng:</label>
          <input
            type="number"
            name="hsl"
            id="hsl"
            class="form-control"
            value="0"
            required
          />
        </div>
        <!-- <div class="col-md-12 mt-3">
          <button type="button" class="btn btn-primary" id="addButton">
            Th√™m
          </button>
        </div> -->

        <div class="col-md-12 mt-3">
          <div class="d-flex justify-content-between align-items-center">
            <!-- N√∫t th√™m b√™n tr√°i -->
            <button type="button" class="btn btn-primary" id="addButton">
              Th√™m
            </button>

            <!-- Ghi ch√∫ b√™n ph·∫£i -->
            <span
              class="text-muted small d-flex align-items-center"
              style="cursor: pointer"
              data-bs-toggle="tooltip"
              data-bs-html="true"
              title="
                <b>Nguy√™n t·∫Øc x√°c ƒë·ªãnh S·ªë ti·ªÅn:</b><br>
                1Ô∏è‚É£ ∆Øu ti√™n theo <b>ƒë·ªô ∆∞u ti√™n</b> (cao tr∆∞·ªõc)<br>
                2Ô∏è‚É£ X√©t <b>H·ªá ƒë√†o t·∫°o</b> & <b>H·ªçc v·ªã</b><br>
                3Ô∏è‚É£ <b>HSL gi·∫£ng vi√™n ‚â• HSL c·∫•u h√¨nh</b><br>
                4Ô∏è‚É£ <b>Ch·ª©c danh</b> t∆∞∆°ng ·ª©ng ho·∫∑c √°p d·ª•ng chung<br>
                5Ô∏è‚É£ N·∫øu c√≥ nhi·ªÅu b·∫£n ghi ph√π h·ª£p -> Ch·ªçn b·∫£n ghi c√≥ <b>S·ªë ti·ªÅn cao nh·∫•t</b><br>
                ‚ùó Kh√¥ng c√≥ b·∫£n ghi ph√π h·ª£p ‚Üí S·ªë ti·ªÅn = 0
              "
            >
              <i class="bi bi-info-circle me-1"></i>
              Quy t·∫Øc √°p d·ª•ng s·ªë ti·ªÅn
            </span>
          </div>
        </div>
      </form>

      <div class="pb-3">
        <table id="NamHocTable" class="table table-bordered">
          <thead>
            <tr>
              <th>STT</th>
              <th id="sortHeDaoTao" style="cursor: pointer">
                H·ªá ƒê√†o T·∫°o <span id="sortIcon">‚áÖ</span>
              </th>
              <th>H·ªçc V·ªã</th>
              <th>S·ªë Ti·ªÅn</th>
              <th>ƒê·ªô ∆∞u ti√™n</th>
              <th>H·ªá s·ªë l∆∞∆°ng</th>
              <th>Ch·ª©c danh</th>
              <th>Thao T√°c</th>
            </tr>
          </thead>
          <tbody id="data-table-body">
            <% if (tienluong && tienluong.length > 0) { %> <% for (var i = 0; i
            < tienluong.length; i++) { %>
            <tr data-id="<%= tienluong[i].STT %>" data-he-dao-tao-id="<%= tienluong[i].he_dao_tao %>" data-chuc-danh-id="<%= tienluong[i].chuc_danh_id %>">
              <td><%= i + 1 %></td>
              <td class="editable he_dao_tao-cell">
                <%= tienluong[i].he_dao_tao_name || tienluong[i].he_dao_tao %>
              </td>
              <td class="editable HocVi-cell"><%= tienluong[i].HocVi %></td>
              <td class="editable SoTien-cell">
                <%= new Intl.NumberFormat('vi-VN', { style: 'currency',
                currency: 'VND' }).format(tienluong[i].SoTien) %>
              </td>

              <!-- ƒê·ªô ∆∞u ti√™n -->
              <td class="editable do_uu_tien-cell">
                <%= tienluong[i].do_uu_tien ?? 0 %>
              </td>

              <!-- HSL -->
              <td class="editable HSL-cell">
                <%= tienluong[i].HSL ?? 0 %>
              </td>

              <!-- Ch·ª©c danh -->
              <td class="editable chuc_danh-cell">
                <%= tienluong[i].chuc_danh_text ?? '' %>
              </td>

              <td class="d-flex justify-content-center" style="border: none">
                <button class="bi bi-pencil action-button edit-btn"></button>
                <button
                  class="bi bi-trash3 action-button me-2"
                  onclick="deleteTienLuong(this, '<%= tienluong[i].STT %>')"
                ></button>
              </td>
            </tr>
            <% } %> <% } %>
          </tbody>
        </table>
      </div>
    </div>

    <script>
      const loadDoUuTienList = () => {
        const select = $('#do_uu_tien');
        select.empty();

        for (let i = 0; i <= 5; i++) {
          select.append(
            `<option value="${i}">${i}</option>`
          );
        }
      };

      document.addEventListener("DOMContentLoaded", function () {
        document
          .querySelectorAll('[data-bs-toggle="tooltip"]')
          .forEach(el => new bootstrap.Tooltip(el));
      });

      // H√†m load danh s√°ch ch·ª©c danh
      $(document).ready(function() {
        loadDoUuTienList();

        $.ajax({
          url: '/api/gvm/v1/chuc-danh-nghe-nghiep-admin',
          method: 'GET',
          success: function(response) {
            if (response.success && response.data) {
              const select = $('#chuc_danh');
              select.empty(); // X√≥a option "ƒêang t·∫£i..."
                            
              // Th√™m c√°c h·ªá ƒë√†o t·∫°o t·ª´ API
              response.data.forEach(function(item) {
                select.append(
                  `<option value="${item.id}">${item.chuc_danh}</option>`
                );
              });
            } else {
              console.error('Kh√¥ng th·ªÉ l·∫•y danh s√°ch h·ªá ƒë√†o t·∫°o');
              $('#chuc_danh').html('<option value="">L·ªói t·∫£i d·ªØ li·ªáu</option>');
            }
          },
          error: function(error) {
            console.error('L·ªói khi g·ªçi API h·ªá ƒë√†o t·∫°o:', error);
            $('#loaiHopDong').html('<option value="">L·ªói k·∫øt n·ªëi</option>');
          }
        });
      });

      $(document).ready(function () {
        // Load danh s√°ch h·ªá ƒë√†o t·∫°o m·ªùi gi·∫£ng t·ª´ API
        $.ajax({
          url: "/api/gvm/v1/he-moi-giang",
          method: "GET",
          success: function(response) {
            if (response.success && response.data) {
              const select = $("#he_dao_tao");
              select.empty(); // X√≥a c√°c option c≈©
              // select.append('<option value="">-- Ch·ªçn h·ªá ƒë√†o t·∫°o --</option>');
              
              response.data.forEach(function(item) {
                select.append(`<option value="${item.id}">${item.he_dao_tao}</option>`);
              });
            }
          },
          error: function(error) {
            console.error("L·ªói khi t·∫£i danh s√°ch h·ªá ƒë√†o t·∫°o:", error);
            Swal.fire({
              title: "Th√¥ng b√°o",
              html: "Kh√¥ng th·ªÉ t·∫£i danh s√°ch h·ªá ƒë√†o t·∫°o",
              icon: "error",
              width: "auto",
              padding: "20px",
              timer: 2000,
              timerProgressBar: true,
              showConfirmButton: false,
            });
          }
        });

        let originalValues = {};

        // G√°n s·ª± ki·ªán cho n√∫t Edit
        $(document).on("click", ".edit-btn", function () {
          const row = $(this).closest("tr");
          const STT = row.data("id");

          // L∆∞u gi√° tr·ªã g·ªëc
          originalValues[STT] = {
            he_dao_tao: row.find(".he_dao_tao-cell").text().trim(),
            he_dao_tao_id: row.data('he-dao-tao-id'),

            HocVi: row.find(".HocVi-cell").text().trim(),

            SoTien: row.find(".SoTien-cell").text().trim(),

            do_uu_tien: row.find(".do_uu_tien-cell").text().trim(),

            HSL: row.find(".HSL-cell").text().trim(),

            chuc_danh_id: row.data('chuc-danh-id'),
            chuc_danh_text: row.find(".chuc_danh-cell").text().trim() // ‚≠ê QUAN TR·ªåNG
          };


          // Chuy·ªÉn text th√†nh combobox cho he_dao_tao
          $.ajax({
            url: "/api/gvm/v1/he-moi-giang",
            method: "GET",
            success: function(response) {
              if (response.success && response.data) {
                let options = '';
                response.data.forEach(function(item) {
                  const selected = item.id == originalValues[STT].he_dao_tao_id ? 'selected' : '';
                  options += `<option value="${item.id}" ${selected}>${item.he_dao_tao}</option>`;
                });
                row.find(".he_dao_tao-cell").html(`<select class="form-control">${options}</select>`);
              }
            },
            error: function(error) {
              console.error("L·ªói khi t·∫£i danh s√°ch h·ªá ƒë√†o t·∫°o:", error);
            }
          });

          // Chuy·ªÉn text th√†nh combobox cho HocVi
          row.find(".HocVi-cell").html(`
            <select class="form-control">
              <option value="C·ª≠ nh√¢n" ${
                originalValues[STT].HocVi === "C·ª≠ nh√¢n" ? "selected" : ""
              }>C·ª≠ nh√¢n</option>

              <option value="K·ªπ s∆∞" ${
                originalValues[STT].HocVi === "K·ªπ s∆∞" ? "selected" : ""
              }>K·ªπ s∆∞</option>

              <option value="Th·∫°c sƒ©" ${
                originalValues[STT].HocVi === "Th·∫°c sƒ©" ? "selected" : ""
              }>Th·∫°c sƒ©</option>

              <option value="Ti·∫øn sƒ©" ${
                originalValues[STT].HocVi === "Ti·∫øn sƒ©" ? "selected" : ""
              }>Ti·∫øn sƒ©</option>

              <option value="Ph√≥ gi√°o s∆∞" ${
                originalValues[STT].HocVi === "Ph√≥ gi√°o s∆∞" ? "selected" : ""
              }>Ph√≥ gi√°o s∆∞</option>

              <option value="Gi√°o s∆∞" ${
                originalValues[STT].HocVi === "Gi√°o s∆∞" ? "selected" : ""
              }>Gi√°o s∆∞</option>

              <option value="Ti·∫øng kh∆°-me" ${
                originalValues[STT].HocVi === "Ti·∫øng kh∆°-me" ? "selected" : ""
              }>Ti·∫øng kh∆°-me</option>

              <option value="V√µ s∆∞" ${
                originalValues[STT].HocVi === "V√µ s∆∞" ? "selected" : ""
              }>V√µ s∆∞</option>
            </select>
          `);


          // Gi·ªØ nguy√™n input cho SoTien
          row.find(".SoTien-cell").html(`
                <input type="number" class="form-control" value="${parseFloat(
                  originalValues[STT].SoTien.replace(/[^0-9-]+/g, "")
                )}">
            `);

          // Chuy·ªÉn text th√†nh combobox cho ƒê·ªô ∆∞u ti√™n
          let uuTienOptions = '';
          for (let i = 0; i <= 5; i++) {
            const selected =
              Number(originalValues[STT].do_uu_tien) === i ? 'selected' : '';
            uuTienOptions += `<option value="${i}" ${selected}>${i}</option>`;
          }
          row
            .find(".do_uu_tien-cell")
            .html(`<select class="form-control">${uuTienOptions}</select>`);

          // Chuy·ªÉn text th√†nh input cho HSL
          row.find(".HSL-cell").html(`
            <input
              type="number"
              step="0.01"
              min="0"
              class="form-control"
              value="${parseFloat(originalValues[STT].HSL) || 0}"
            />
          `);


          // Chuy·ªÉn text th√†nh combobox cho Ch·ª©c danh
          $.ajax({
            url: "/api/gvm/v1/chuc-danh-nghe-nghiep-admin",
            method: "GET",
            success: function (response) {
              if (response.success && response.data) {
                let options = '';

                response.data.forEach(function (item) {
                  const selected =
                    item.id == originalValues[STT].chuc_danh_id ? 'selected' : '';

                  options += `
                    <option value="${item.id}" ${selected}>
                      ${item.chuc_danh}
                    </option>
                  `;
                });

                row
                  .find(".chuc_danh-cell")
                  .html(`<select class="form-control">${options}</select>`);
              }
            },
            error: function (err) {
              console.error("L·ªói khi t·∫£i danh s√°ch ch·ª©c danh:", err);
            },
          });


          // Th√™m n√∫t Save v√† Cancel v√†o cell cu·ªëi
          const actionCell = row.find("td:last-child");
          actionCell.html(`
                <button class="save-btn btn btn-success btn-sm">L∆∞u</button>
                <button class="cancel-btn btn btn-danger btn-sm ms-2">H·ªßy</button>
            `);

          // ·∫®n n√∫t Edit
          $(this).hide();
        });

        // X·ª≠ l√Ω khi nh·∫•n n√∫t Save
        $(document).on("click", ".save-btn", function () {
          const row = $(this).closest("tr");
          const STT = row.data("id");

          const updatedData = {
            he_dao_tao: row.find(".he_dao_tao-cell select").val(),
            HocVi: row.find(".HocVi-cell select").val(),
            SoTien: row.find(".SoTien-cell input").val(),
            do_uu_tien: row.find(".do_uu_tien-cell select").val(),
            hsl: row.find(".HSL-cell input").val(),
            chuc_danh_id: row.find(".chuc_danh-cell select").val(),
          };

          debugger
          console.log(updatedData)

          const he_dao_tao_text =
            row.find(".he_dao_tao-cell select option:selected").text();

          const chuc_danh_text =
            row.find(".chuc_danh-cell select option:selected").text();
            
          $.ajax({
            url: `/tienluong/${STT}`,
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify(updatedData),
            success: function (response) {
              // C·∫≠p nh·∫≠t giao di·ªán
              row.find(".he_dao_tao-cell").text(he_dao_tao_text);
              row.find(".HocVi-cell").text(updatedData.HocVi);
              row.find(".SoTien-cell").text(
                new Intl.NumberFormat("vi-VN", {
                  style: "currency",
                  currency: "VND",
                }).format(updatedData.SoTien)
              );
              row.find(".do_uu_tien-cell").text(updatedData.do_uu_tien);
              row.find(".HSL-cell").text(updatedData.hsl);
              row.find(".chuc_danh-cell").text(chuc_danh_text);

                // üëâ ƒê·∫∂T ·ªû ƒê√ÇY
              row.data("he-dao-tao-id", updatedData.he_dao_tao);
              row.data("chuc-danh-id", updatedData.chuc_danh_id);

              const actionCell = row.find("td:last-child");
              actionCell.html(`
                        <button class="bi bi-pencil action-button edit-btn"></button>
                        <button class="bi bi-trash3 action-button me-2" onclick="deleteTienLuong(this, '${STT}')"></button>
                    `);

              Swal.fire({
                title: "Th√¥ng b√°o",
                html: "C·∫≠p nh·∫≠t th√†nh c√¥ng!",
                icon: "success",
                width: "auto",
                padding: "20px",
                timer: 2000,
                timerProgressBar: true,
                showConfirmButton: false,
              });
            },
            error: function (error) {
              Swal.fire({
                title: "Th√¥ng b√°o",
                html: "C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t",
                icon: "error",
                width: "auto",
                padding: "20px",
                timer: 2000,
                timerProgressBar: true,
                showConfirmButton: false,
              });
            },
          });
        });

        // X·ª≠ l√Ω khi nh·∫•n n√∫t Cancel
        $(document).on("click", ".cancel-btn", function () {
          const row = $(this).closest("tr");
          const STT = row.data("id");

          // Kh√¥i ph·ª•c gi√° tr·ªã g·ªëc
          row.find(".he_dao_tao-cell").text(originalValues[STT].he_dao_tao);
          row.find(".HocVi-cell").text(originalValues[STT].HocVi);
          row.find(".SoTien-cell").text(originalValues[STT].SoTien);
          row.find(".he_dao_tao-cell").text(originalValues[STT].he_dao_tao);
          row.find(".do_uu_tien-cell").text(originalValues[STT].do_uu_tien);
          row.find(".HSL-cell").text(originalValues[STT].HSL);
          row.find(".chuc_danh-cell").text(originalValues[STT].chuc_danh_text);


          // Kh√¥i ph·ª•c n√∫t Edit
          const actionCell = row.find("td:last-child");
          actionCell.html(`
                <button class="bi bi-pencil action-button edit-btn"></button>
                <button class="bi bi-trash3 action-button me-2" 
                    onclick="deleteTienLuong(this, '${STT}')">
                </button>
            `);
        });

        $("#addButton").click(function (event) {
          event.preventDefault(); // NgƒÉn ch·∫∑n h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh c·ªßa n√∫t

          const he_dao_tao = $("#he_dao_tao").val();
          const hocVi = $("#HocVi").val();
          const soTien = $("#SoTien").val();
          const hsl = $("#hsl").val();
          // const khoa = $("#khoa").val();
          const khoa = 'ALL';
          const do_uu_tien = $("#do_uu_tien").val();
          const chuc_danh_id = $("#chuc_danh").val();

          // Ki·ªÉm tra s·ª± t·ªìn t·∫°i
          $.ajax({
            url: "/checkExistence",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({ he_dao_tao: he_dao_tao, HocVi: hocVi, khoa, hsl, chuc_danh_id }),
            success: function (response) {
              // N·∫øu kh√¥ng t·ªìn t·∫°i, ti·∫øp t·ª•c th√™m m·ªõi
              addNewEntry(he_dao_tao, hocVi, soTien, do_uu_tien, khoa, hsl, chuc_danh_id);
            },
            error: function (xhr) {
              if (xhr.status === 409) {
                Swal.fire({
                  title: "Th√¥ng b√°o",
                  html: xhr.responseJSON.message,
                  icon: "error",
                  width: "auto",
                  padding: "20px",
                  timer: 2000,
                  timerProgressBar: true,
                  showConfirmButton: false,
                });
              } else {
                Swal.fire({
                  title: "Th√¥ng b√°o",
                  html: "C√≥ l·ªói x·∫£y ra khi ki·ªÉm tra s·ª± t·ªìn t·∫°i",
                  icon: "error",
                  width: "auto",
                  padding: "20px",
                  timer: 2000,
                  timerProgressBar: true,
                  showConfirmButton: false,
                });
              }
            },
          });
        });

        function addNewEntry(he_dao_tao, hocVi, soTien, do_uu_tien, khoa, hsl, chuc_danh_id) {
          $.ajax({
            url: "/tienluong",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify({
              he_dao_tao: he_dao_tao,
              HocVi: hocVi,
              SoTien: soTien,
              do_uu_tien,
              khoa,
              hsl,
              chuc_danh_id
            }),
            success: function (response) {
              Swal.fire({
                title: "Th√¥ng b√°o",
                html: "Th√™m m·ªõi th√†nh c√¥ng!",
                icon: "success",
                width: "auto",
                padding: "20px",
                timer: 2000,
                timerProgressBar: true,
                showConfirmButton: false,
              }).then(() => {
                location.reload();
              });
            },
            error: function (error) {
              Swal.fire({
                title: "Th√¥ng b√°o",
                html: "C√≥ l·ªói x·∫£y ra khi th√™m m·ªõi",
                icon: "error",
                width: "auto",
                padding: "20px",
                timer: 2000,
                timerProgressBar: true,
                showConfirmButton: false,
              });
            },
          });
        }

        let sortAsc = true;
        $("#sortHeDaoTao").click(function () {
          let rows = $("#data-table-body tr").get();
          rows.sort(function (a, b) {
            let keyA = $(a).find(".he_dao_tao-cell").text().toUpperCase();
            let keyB = $(b).find(".he_dao_tao-cell").text().toUpperCase();
            if (keyA < keyB) return sortAsc ? -1 : 1;
            if (keyA > keyB) return sortAsc ? 1 : -1;
            return 0;
          });
          $.each(rows, function (index, row) {
            $("#data-table-body").append(row);
            $(row)
              .find("td:first")
              .text(index + 1); // c·∫≠p nh·∫≠t l·∫°i STT
          });
          sortAsc = !sortAsc;
          $("#sortIcon").text(sortAsc ? "‚áÖ" : "‚áµ");
        });
      });

      function deleteTienLuong(button, STT) {
        Swal.fire({
          title: "X√°c nh·∫≠n",
          html: "B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√¥ng?",
          icon: "warning",
          showCancelButton: true,
          confirmButtonText: "ƒê·ªìng √Ω",
          cancelButtonText: "H·ªßy",
          width: "auto",
          padding: "20px",
        }).then((result) => {
          if (result.isConfirmed) {
            fetch(`/tienluong/${STT}`, {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json",
              },
            })
              .then((response) => {
                if (response.ok) {
                  Swal.fire({
                    title: "Th√¥ng b√°o",
                    html: "X√≥a th√†nh c√¥ng!",
                    icon: "success",
                    width: "auto",
                    padding: "20px",
                    timer: 2000,
                    timerProgressBar: true,
                    showConfirmButton: false,
                  }).then(() => {
                    button.closest("tr").remove();
                  });
                } else {
                  return response.text().then((text) => {
                    Swal.fire({
                      title: "Th√¥ng b√°o",
                      html: "C√≥ l·ªói x·∫£y ra khi x√≥a",
                      icon: "error",
                      width: "auto",
                      padding: "20px",
                      timer: 2000,
                      timerProgressBar: true,
                      showConfirmButton: false,
                    });
                  });
                }
              })
              .catch((error) => {
                Swal.fire({
                  title: "Th√¥ng b√°o",
                  html: "C√≥ l·ªói x·∫£y ra: " + error.message,
                  icon: "error",
                  width: "auto",
                  padding: "20px",
                  timer: 2000,
                  timerProgressBar: true,
                  showConfirmButton: false,
                });
              });
          }
        });
      }
    </script>
  </body>
</html>
